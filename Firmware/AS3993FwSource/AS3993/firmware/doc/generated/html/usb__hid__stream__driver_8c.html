<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>as3993 Firmware: usb_hid_stream_driver.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">as3993 Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bdd9a5d540de89e9fe90efdfc6973a4f.html">common</a></li><li class="navelem"><a class="el" href="dir_d3e01d84417a30ad319070c1f4e344b7.html">firmware</a></li><li class="navelem"><a class="el" href="dir_f2eb04dc0cf048ef1052bb62b9646e92.html">microchip</a></li><li class="navelem"><a class="el" href="dir_5a76aee4bd82329bd4bd60430712f9aa.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">usb_hid_stream_driver.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="ams__stream_8h_source.html">ams_stream.h</a>&quot;</code><br/>
<code>#include &quot;GenericTypeDefs.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="errno_8h_source.html">errno.h</a>&quot;</code><br/>
<code>#include &quot;stream_driver.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="stream__dispatcher_8h_source.html">stream_dispatcher.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="usb__hid__stream__driver_8h_source.html">usb_hid_stream_driver.h</a>&quot;</code><br/>
<code>#include &quot;usb.h&quot;</code><br/>
<code>#include &quot;usb_function_hid.h&quot;</code><br/>
<code>#include &quot;ams_types.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="logger_8h_source.html">logger.h</a>&quot;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
</div>
<p><a href="usb__hid__stream__driver_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a130bc3ba99625b4dcabe8f1db0136900"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#a130bc3ba99625b4dcabe8f1db0136900">usbStreamInitialize</a> (u8 *rxBuf, u8 *txBuf)</td></tr>
<tr class="separator:a130bc3ba99625b4dcabe8f1db0136900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa05403d4ec6e9e1de03c8c8973ce90d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afa05403d4ec6e9e1de03c8c8973ce90d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#afa05403d4ec6e9e1de03c8c8973ce90d">usbStreamConnect</a> (void)</td></tr>
<tr class="separator:afa05403d4ec6e9e1de03c8c8973ce90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4adb939a20abb01afafe5bea1bb5fe"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4f4adb939a20abb01afafe5bea1bb5fe"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#a4f4adb939a20abb01afafe5bea1bb5fe">usbStreamDisconnect</a> (void)</td></tr>
<tr class="separator:a4f4adb939a20abb01afafe5bea1bb5fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa453cb7337ad8f066443d965b5525711"><td class="memItemLeft" align="right" valign="top">u8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#aa453cb7337ad8f066443d965b5525711">usbStreamReady</a> (void)</td></tr>
<tr class="separator:aa453cb7337ad8f066443d965b5525711"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ce3ea431eb2d7a95c9faf4722dcc8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#ae1ce3ea431eb2d7a95c9faf4722dcc8b">usbStreamPacketProcessed</a> (u16 rxed)</td></tr>
<tr class="separator:ae1ce3ea431eb2d7a95c9faf4722dcc8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85e0711dfb975df710338d23e77c120c"><td class="memItemLeft" align="right" valign="top">s8&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#a85e0711dfb975df710338d23e77c120c">usbStreamHasAnotherPacket</a> ()</td></tr>
<tr class="separator:a85e0711dfb975df710338d23e77c120c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3604eee9733277912e50aa59643522c"><td class="memItemLeft" align="right" valign="top">u16&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#aa3604eee9733277912e50aa59643522c">usbStreamReceive</a> ()</td></tr>
<tr class="separator:aa3604eee9733277912e50aa59643522c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c223c5886b6a7bc46c3b0889082c36f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#a8c223c5886b6a7bc46c3b0889082c36f">usbStreamTransmit</a> (u16 totalTxSize)</td></tr>
<tr class="separator:a8c223c5886b6a7bc46c3b0889082c36f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b9e213bc43eabcb9b14a8b6b750159"><td class="memItemLeft" align="right" valign="top">BOOL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#a47b9e213bc43eabcb9b14a8b6b750159">USER_USB_CALLBACK_EVENT_HANDLER</a> (USB_EVENT event, void *pdata, WORD size)</td></tr>
<tr class="separator:a47b9e213bc43eabcb9b14a8b6b750159"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a89a8079dd2eda7b835a0fc306d22711f"><td class="memItemLeft" align="right" valign="top">static u8 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="usb__hid__stream__driver_8c.html#a89a8079dd2eda7b835a0fc306d22711f">txBuffer</a></td></tr>
<tr class="separator:a89a8079dd2eda7b835a0fc306d22711f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>USB HID streaming driver implementation. </p>
<dl class="section author"><dt>Author</dt><dd>Wolfgang Reichart M. Arpa </dd></dl>

<p>Definition in file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a85e0711dfb975df710338d23e77c120c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">s8 usbStreamHasAnotherPacket </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns 1 if another packet is available in buffer </p>
<dl class="section return"><dt>Returns</dt><dd>0=no packet available in buffer, 1=another packet available </dd></dl>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00147">147</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<a class="anchor" id="a130bc3ba99625b4dcabe8f1db0136900"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void usbStreamInitialize </td>
          <td>(</td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>rxBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u8 *&#160;</td>
          <td class="paramname"><em>txBuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>initializes the USB HID Stream driver variables </p>
<p>This function takes care for proper initialisation of buffers, variables, etc.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rxBuf</td><td>: buffer where received packets will be copied into </td></tr>
    <tr><td class="paramname">txBuf</td><td>: buffer where to be transmitted packets will be copied into </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00088">88</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae1ce3ea431eb2d7a95c9faf4722dcc8b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void usbStreamPacketProcessed </td>
          <td>(</td>
          <td class="paramtype">u16&#160;</td>
          <td class="paramname"><em>rxed</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tells the stream driver that the packet has been processed and can be moved from the rx buffer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">rxed</td><td>: number of bytes which have been processed </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00123">123</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa453cb7337ad8f066443d965b5525711"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u8 usbStreamReady </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns 1 if stream init is finished </p>
<dl class="section return"><dt>Returns</dt><dd>0=init has not finished yet, 1=stream has been initialized </dd></dl>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00115">115</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<a class="anchor" id="aa3604eee9733277912e50aa59643522c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">u16 usbStreamReceive </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>checks if there is data received on the HID device from the host and copies the received data into a local buffer </p>
<p>Checks if the usb HID device has data received from the host, copies this data into a local buffer. The data in the local buffer is than interpreted as a packet (with header, rx-length and tx-length). As soon as a full packet is received the function returns non-null.</p>
<dl class="section return"><dt>Returns</dt><dd>0 = nothing to process, &gt;0 at least 1 packet to be processed </dd></dl>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00186">186</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8c223c5886b6a7bc46c3b0889082c36f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void usbStreamTransmit </td>
          <td>(</td>
          <td class="paramtype">u16&#160;</td>
          <td class="paramname"><em>totalTxSize</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>checks if there is data to be transmitted from the HID device to the host. </p>
<p>Checks if there is data waiting to be transmitted to the host. Copies this data from a local buffer to the usb buffer and transmits this usb buffer. If more than 1 usb hid report is needed to transmit the data, the function waits until the first one is sent, and than refills the usb buffer with the next chunk of data and transmits the usb buffer again. And so on, until all data is sent.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">totalTxSize,:</td><td>the size of the data to be transmitted (the HID header is not included) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00245">245</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<a class="anchor" id="a47b9e213bc43eabcb9b14a8b6b750159"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOL USER_USB_CALLBACK_EVENT_HANDLER </td>
          <td>(</td>
          <td class="paramtype">USB_EVENT&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pdata</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WORD&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Function Prototypes </p>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00629">629</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a89a8079dd2eda7b835a0fc306d22711f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static u8 txBuffer</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>buffer to store protocol packets received from the Host </p>

<p>Definition at line <a class="el" href="usb__hid__stream__driver_8c_source.html#l00073">73</a> of file <a class="el" href="usb__hid__stream__driver_8c_source.html">usb_hid_stream_driver.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 7 2015 14:12:44 for as3993 Firmware by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
