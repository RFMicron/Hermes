<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>as3993 Firmware: Build Environment</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">as3993 Firmware
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Build Environment </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This file explains how to configure the build environment and tools for building AS3993 Firmware (FW).</p>
<h1><a class="anchor" id="buildreq"></a>
Requirements</h1>
<p>Before building the AS3993 FW you need to setup the required build tools. Requirements are:</p>
<ul>
<li>An installation of c30 pic compiler</li>
<li>An User environment variable c30dir which contains the installation dir of c30 (eg: C:\MPLABC30)</li>
<li>Optionally: A MPLAB X installation</li>
</ul>
<h1><a class="anchor" id="buildsource"></a>
Source code delivery content</h1>
<p>The AS3993 FW delivery contains the FW source code including a Makefile and MPLAB X project files. The MPLAB X project files are provided for your convenience to get a working debugging environment very fast. <br/>
However, the officially release FW builds are always generated with the Makefile as it is more flexible in handling the various build configurations. Therefore the reliable way to get a correctly configured fw build is to use the Makefile. <br/>
The output of the Makefile build is build/as3993.bin.</p>
<h1><a class="anchor" id="buildvars"></a>
Build Configuration variables</h1>
<p>The build configurations are:</p>
<ul>
<li>UART Logger enabled/disabled (USE_LOGGER in Makefile)</li>
<li>UART host communication instead of USB (USE_UART_STREAM_DRIVER in Makefile)</li>
<li>target CPU device, defaults to 24FJ64GB002 but can be changed in build environment (CPU in Makefile)</li>
<li>bootloader support, defaults to enabled but can be disabled in build environment (ENABLE_BOOTLOADER in Makefile)</li>
<li>Fermi, Femto, Mega target board (each target board has a define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a>)</li>
<li>AS3993/AS3994/AS3980 support (each reader has a define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a>)</li>
</ul>
<dl class="section attention"><dt>Attention</dt><dd>When UART host communication is used, UART logger has to be disabled as the logging output on the UART will break communication between board and host.<br/>
 Therefore USE_LOGGER and USE_UART_STREAM_DRIVER are not allowed to be defined at the same time. The resulting binary would not be able to communicate without errors with the host, because every log message which is printed on uart will break protocol data flow.</dd></dl>
<h1><a class="anchor" id="buildexample"></a>
Build examples</h1>
<p>Building of the FW for various configurations is handled in the createDelivery.sh script, which can be executed eg. in a cygwin environment. Have a look at it to get a feeling how each configuration is handled differently. 3 examples will be discussed in detail: </p>
<h2><a class="anchor" id="buildfemto"></a>
FEMTO AS3993 with uart logging enabled:</h2>
<ul>
<li>set FEMTO define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a> to 1, set other board defines to 0</li>
<li>set RUN_ON_AS3993 define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a> to 1, set other reader defines to 0</li>
<li>execute: make clean</li>
<li>execute: make USE_LOGGER=1 <dl class="section note"><dt>Note</dt><dd>If you want uart logging completely disabled, execute make without any parameter.</dd></dl>
</li>
</ul>
<h2><a class="anchor" id="builduart"></a>
FEMTO AS3993 with uart host communication enabled:</h2>
<ul>
<li>set FEMTO define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a> to 1, set other board defines to 0</li>
<li>set RUN_ON_AS3993 define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a> to 1, set other reader defines to 0</li>
<li>execute: make clean</li>
<li>execute: make USE_UART_STREAM_DRIVER=1 <dl class="section note"><dt>Note</dt><dd>Do not use USE_UART_STREAM_DRIVER in combination with USE_LOGGER except if you want to debug problems and know what you are doing. Host communication will fail when a log messages is printed on UART.</dd></dl>
</li>
</ul>
<h2><a class="anchor" id="buildmega"></a>
MEGA AS3994 with uart host communication and without bootloader support:</h2>
<ul>
<li>set MEGA define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a> to 1, set other board defines to 0</li>
<li>set RUN_ON_AS3994 define in <a class="el" href="as3993__config_8h.html" title="Configuration file for all AS99x firmware. ">as3993_config.h</a> to 1, set other reader defines to 0</li>
<li>execute: make clean</li>
<li>execute: make USE_UART_STREAM_DRIVER=1 CPU=24FJ256GB110 DISABLE_BOOTLOADER=1 </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 7 2015 14:12:44 for as3993 Firmware by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
